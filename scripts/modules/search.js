var q=".body";var D="#message",b="#search-modal-content",w=".element",M="element--active";var g=".element__contacts",O="element__contacts--open",U=".element__counter",I="element__counter--active";var h=".column__element",l=".message",i=".message__name",E=".message__position",u=".message__phone",x=".contact-table",y=".js-delete-contact-button",C=".js-edit-contact-button";var B="#edit-popup-content",k="#popup-name",G="#popup-position",F="#popup-phone";var V=".modal",$=".modal__title",K=".modal__body",Y=".modal__input",A=".modal__search-area",j=".modal__button-show";var f=class{constructor(e,n){this.counterElement=e,this.contactsContainer=n,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(I),e.classList.add(M)):(this.counterElement.classList.remove(I),e.classList.remove(M))),this.counterElement.textContent=this.count.toString()}};function W(t){let e=localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",n),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return null}function J(t,e){localStorage.setItem(t,JSON.stringify(e))}var z="contacts",m=W(z)||[];function p(){return m}function Z({name:t,position:e,phone:n}){m=m.filter(o=>o.name!==t||o.position!==e||o.phone!==n),J(z,m)}function Q(t){return m.filter(({name:e,position:n,phone:o})=>e.toLowerCase().includes(t.toLowerCase())||n.toLowerCase().includes(t.toLowerCase())||o.includes(t))}var X=t=>t.key==="Escape";var r=document.querySelector(V),tt=document.querySelector(q);function L(t){r.showModal(),tt.style.overflow="hidden";let e=r.querySelector(K);e.innerHTML="";let n=t.content.cloneNode(!0);e.appendChild(n),r.querySelector("input").focus(),document.addEventListener("keydown",d)}function et(){r.close(),tt.style.overflow="auto",document.removeEventListener("keydown",d)}function d(t){X(t)&&(t.preventDefault(),et())}var nt=document.querySelector(B),H,N,R,ct=null;function v(t){nt&&L(nt);let e=r.querySelector($);e&&(e.textContent="Edit contact"),ct=t,H=r.querySelector(k),N=r.querySelector(G),R=r.querySelector(F),H&&N&&R&&(H.value=t.name,N.value=t.position,R.value=t.phone),r.querySelector("input").focus(),document.addEventListener("keydown",d)}var _={};function P({name:t,position:e,phone:n}){let s=document.querySelector(D).content.querySelector(l)?.cloneNode(!0);if(s){let a=s.querySelector(i),T=s.querySelector(E),S=s.querySelector(u);a.textContent=t,T.textContent=e,S.textContent=n}return s}function at(t,e){e.innerHTML="",t.forEach(({name:n,position:o,phone:c})=>{let s=P({name:n,position:o,phone:c});e.append(s)})}function lt(t,e){let n=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(h);if(n){let o=n.querySelector(g);at(e,o);let c=n.querySelector(U);_[t]||(_[t]=new f(c,o)),_[t].count=e.length,_[t].update()}}function ot(t){let n=t.target.closest(l);if(!n)return;let o=n.querySelector(i)?.textContent??"",c=n.querySelector(E)?.textContent??"",s=n.querySelector(u)?.textContent??"";Z({name:o,position:c,phone:s}),n.remove();let a=o[0].toUpperCase(),T=p().filter(S=>S.name[0].toUpperCase()===a);lt(a,T)}function rt(t){let e=t.target;if(e.closest(h)){let n=e.closest(w);if(!n)return;let o=n.querySelector(g);if(!o)return;o.classList.toggle(O),o.classList.contains(O)?o.style.maxHeight=`${o.scrollHeight}px`:o.style.maxHeight="0"}}document.querySelector(x)?.addEventListener("click",t=>{let e=t.target;if(e.closest(y)){ot(t);return}if(e.closest(C)){let n=e.closest(l),o=n.querySelector(i)?.textContent??"",c=n.querySelector(E)?.textContent??"",s=n.querySelector(u)?.textContent??"";v({name:o,position:c,phone:s})}rt(t)});document.querySelector(x)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let n=t.target;if(n.matches(y)){ot(t);return}if(n.closest(C)){let o=n.closest(l),c=o.querySelector(i)?.textContent??"",s=o.querySelector(E)?.textContent??"",a=o.querySelector(u)?.textContent??"";v({name:c,position:s,phone:a})}rt(t)}});var it=document.querySelector(b);function st(t,e){if(e.innerHTML="",t.length===0){e.textContent="No results found";return}t.forEach(({name:n,position:o,phone:c})=>{let s=P({name:n,position:o,phone:c});e.appendChild(s)})}function Et(t,e){t.addEventListener("input",()=>{let n=t.value.trim().toLowerCase();if(n){let o=Q(n);st(o,e)}else e.innerHTML=""})}function Wt(){L(it);let t=r.querySelector(Y),e=r.querySelector(A);Et(t,e),r.querySelector(j).addEventListener("click",ut)}function ut(){let t=p(),e=r.querySelector(A);st(t,e),r.querySelector("input").focus()}export{Wt as openSearchModal,ut as showAllContacts};
