var q=".body";var D="#message",b="#search-modal-content",w=".element",M="element--active";var O=".element__contacts",I="element__contacts--open",U=".element__counter",h="element__counter--active";var g=".column__element",l=".message",E=".message__name",i=".message__position",u=".message__phone",x=".contact-table",y=".js-delete-contact-button",C=".js-edit-contact-button";var B="#edit-popup-content",k="#popup-name",G="#popup-position",F="#popup-phone";var V=".modal",$=".modal__title",K=".modal__body",Y=".modal__input",A=".modal__search-area",j=".modal__button-show";var f=class{constructor(e,o){this.counterElement=e,this.contactsContainer=o,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(h),e.classList.add(M)):(this.counterElement.classList.remove(h),e.classList.remove(M))),this.counterElement.textContent=this.count.toString()}};function W(t){let e=localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",o),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return null}function J(t,e){localStorage.setItem(t,JSON.stringify(e))}var z="contacts",m=W(z)||[];function p(){return m}function Z({name:t,position:e,phone:o}){m=m.filter(n=>n.name!==t||n.position!==e||n.phone!==o),J(z,m)}function Q(t){return m.filter(({name:e,position:o,phone:n})=>e.toLowerCase().includes(t.toLowerCase())||o.toLowerCase().includes(t.toLowerCase())||n.includes(t))}var X=t=>t.key==="Escape";var r=document.querySelector(V),tt=document.querySelector(q);function L(t){r.showModal(),tt.style.overflow="hidden";let e=r.querySelector(K);e.innerHTML="";let o=t.content.cloneNode(!0);e.appendChild(o),r.querySelector("input").focus(),document.addEventListener("keydown",d)}function et(){r.close(),tt.style.overflow="auto",document.removeEventListener("keydown",d)}function d(t){X(t)&&(t.preventDefault(),et())}var ot=document.querySelector(B),H,N,R,ct=null;function v(t){ot&&L(ot);let e=r.querySelector($);e&&(e.textContent="Edit contact"),ct=t,H=r.querySelector(k),N=r.querySelector(G),R=r.querySelector(F),H&&N&&R&&(H.value=t.name,N.value=t.position,R.value=t.phone),r.querySelector("input").focus(),document.addEventListener("keydown",d)}var _={};function P({name:t,position:e,phone:o}){let s=document.querySelector(D).content.querySelector(l)?.cloneNode(!0);if(s){let a=s.querySelector(E),T=s.querySelector(i),S=s.querySelector(u);a.textContent=t,T.textContent=e,S.textContent=o}return s}function at(t,e){e.innerHTML="",t.forEach(({name:o,position:n,phone:c})=>{let s=P({name:o,position:n,phone:c});e.append(s)})}function lt(t,e){let o=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(g);if(o){let n=o.querySelector(O);at(e,n);let c=o.querySelector(U);_[t]||(_[t]=new f(c,n)),_[t].count=e.length,_[t].update()}}function nt(t){let o=t.target.closest(l);if(!o)return;let n=o.querySelector(E)?.textContent??"",c=o.querySelector(i)?.textContent??"",s=o.querySelector(u)?.textContent??"";Z({name:n,position:c,phone:s}),o.remove();let a=n[0].toUpperCase(),T=p().filter(S=>S.name[0].toUpperCase()===a);lt(a,T)}function rt(t){let e=t.target;if(e.closest(g)){let o=e.closest(w);if(!o)return;let n=o.querySelector(O);if(!n)return;n.classList.toggle(I),n.classList.contains(I)?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight="0"}}document.querySelector(x)?.addEventListener("click",t=>{let e=t.target;if(e.closest(y)){nt(t);return}if(e.closest(C)){let o=e.closest(l),n=o.querySelector(E)?.textContent??"",c=o.querySelector(i)?.textContent??"",s=o.querySelector(u)?.textContent??"";v({name:n,position:c,phone:s})}rt(t)});document.querySelector(x)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let o=t.target;if(o.matches(y)){nt(t);return}if(o.closest(C)){let n=o.closest(l),c=n.querySelector(E)?.textContent??"",s=n.querySelector(i)?.textContent??"",a=n.querySelector(u)?.textContent??"";v({name:c,position:s,phone:a})}rt(t)}});var Et=document.querySelector(b);function st(t,e){if(e.innerHTML="",t.length===0){e.textContent="No results found";return}t.forEach(({name:o,position:n,phone:c})=>{let s=P({name:o,position:n,phone:c});e.appendChild(s)})}function it(t,e){t.addEventListener("input",()=>{let o=t.value.trim().toLowerCase();if(o){let n=Q(o);st(n,e)}else e.innerHTML=""})}function Wt(){L(Et);let t=r.querySelector(Y),e=r.querySelector(A);it(t,e),r.querySelector(j).addEventListener("click",ut)}function ut(){let t=p(),e=r.querySelector(A);st(t,e),r.querySelector("input").focus()}export{Wt as openSearchModal,ut as showAllContacts};
