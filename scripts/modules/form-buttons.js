var K=3,j="input--error";function Nt(t,e){t.forEach(n=>{n.classList.remove(j)}),e.textContent=""}function H(t,e,n){t.classList.add(j),e.textContent=n}function Rt(t){let e=[];return t.forEach(n=>{n.value.trim()||e.push({input:n,message:"Fill in all fields!"})}),e}function vt(t,{name:e,position:n,phone:o}){return t.some(r=>r.name?.toLowerCase()===e.toLowerCase()&&r.position?.toLowerCase()===n.toLowerCase()&&r.phone===o)?[{input:null,message:"This contact has already been recorded!"}]:[]}function Y(t,e){let n=[],o=/^[a-zA-Z]+$/;return t.value.length<e&&n.push({input:t,message:`Value cannot be shorter than ${e} letters!`}),o.test(t.value)||n.push({input:t,message:"Value must contain English letters!"}),n}function Pt(t){return/^\+7 \d{3} \d{3} \d{2} \d{2}$/.test(t.value)?[]:[{input:t,message:"Wrong number!"}]}function x(t,e,n){let[o,s,r]=t;Nt(t,n);let a=Rt(t);if(a.length>0)return{ok:!1,errors:a};let l={name:o.value,position:s.value,phone:r.value},E=vt(e,l);if(E.length>0)return{ok:!1,errors:E};let C=Y(o,K);if(C.length>0)return{ok:!1,errors:C};let f=Y(s,K);if(f.length>0)return{ok:!1,errors:f};let V=Pt(r);return V.length>0?{ok:!1,errors:V}:{ok:!0,errors:[]}}var W=".body";var J="#message",z="#search-modal-content",Z=".element",N="element--active";var L=".element__contacts",R="element__contacts--open",M=".element__counter",v="element__counter--active";var m=".column__element",p=".message",d=".message__name",_=".message__position",S=".message__phone",P=".contact-table",q=".js-delete-contact-button",O=".js-edit-contact-button",Q=".js-clear-contact-button",X=".js-search-contact-button",tt="#edit-popup-content",et="#popup-name",nt="#popup-position",ot="#popup-phone";var rt=".modal",st=".modal__title",ct=".modal__body",at=".modal__input",D=".modal__search-area",lt=".modal__button-show";var it=".form",Et="name",ut="position",mt="phone",pt=".form__error",Tt=".form__buttons";var T=class{constructor(e,n){this.counterElement=e,this.contactsContainer=n,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(v),e.classList.add(N)):(this.counterElement.classList.remove(v),e.classList.remove(N))),this.counterElement.textContent=this.count.toString()}};function Ct(t){let e=localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",n),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return null}function g(t,e){localStorage.setItem(t,JSON.stringify(e))}var I="contacts",i=Ct(I)||[];function u(){return i}function ft({name:t,position:e,phone:n}){let o={name:t,position:e,phone:n};i.push(o),g(I,i)}function Lt({name:t,position:e,phone:n}){i=i.filter(o=>o.name!==t||o.position!==e||o.phone!==n),g(I,i)}function dt(t){return i.filter(({name:e,position:n,phone:o})=>e.toLowerCase().includes(t.toLowerCase())||n.toLowerCase().includes(t.toLowerCase())||o.includes(t))}function _t(){i=[],g(I,i)}var St=t=>t.key==="Escape";var c=document.querySelector(rt),Mt=document.querySelector(W);function h(t){c.showModal(),Mt.style.overflow="hidden";let e=c.querySelector(ct);e.innerHTML="";let n=t.content.cloneNode(!0);e.appendChild(n),c.querySelector("input").focus(),document.addEventListener("keydown",y)}function Ot(){c.close(),Mt.style.overflow="auto",document.removeEventListener("keydown",y)}function y(t){St(t)&&(t.preventDefault(),Ot())}var gt=document.querySelector(tt),w,b,B,qt=null;function U(t){gt&&h(gt);let e=c.querySelector(st);e&&(e.textContent="Edit contact"),qt=t,w=c.querySelector(et),b=c.querySelector(nt),B=c.querySelector(ot),w&&b&&B&&(w.value=t.name,b.value=t.position,B.value=t.phone),c.querySelector("input").focus(),document.addEventListener("keydown",y)}var A={};function k({name:t,position:e,phone:n}){let r=document.querySelector(J).content.querySelector(p)?.cloneNode(!0);if(r){let a=r.querySelector(d),l=r.querySelector(_),E=r.querySelector(S);a.textContent=t,l.textContent=e,E.textContent=n}return r}function Dt(t,e){e.innerHTML="",t.forEach(({name:n,position:o,phone:s})=>{let r=k({name:n,position:o,phone:s});e.append(r)})}function It(t,e){let n=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(m);if(n){let o=n.querySelector(L);Dt(e,o);let s=n.querySelector(M);A[t]||(A[t]=new T(s,o)),A[t].count=e.length,A[t].update()}}function ht({name:t,position:e,phone:n},o,s=!0){s&&ft({name:t,position:e,phone:n});let r=o.querySelector("[data-id]")?.textContent?.toUpperCase()??"",a=u().filter(l=>l.name[0].toUpperCase()===r);It(r,a)}function yt(t){let n=t.target.closest(p);if(!n)return;let o=n.querySelector(d)?.textContent??"",s=n.querySelector(_)?.textContent??"",r=n.querySelector(S)?.textContent??"";Lt({name:o,position:s,phone:r}),n.remove();let a=o[0].toUpperCase(),l=u().filter(E=>E.name[0].toUpperCase()===a);It(a,l)}function At(t){let e=t.target;if(e.closest(m)){let n=e.closest(Z);if(!n)return;let o=n.querySelector(L);if(!o)return;o.classList.toggle(R),o.classList.contains(R)?o.style.maxHeight=`${o.scrollHeight}px`:o.style.maxHeight="0"}}document.querySelector(P)?.addEventListener("click",t=>{let e=t.target;if(e.closest(q)){yt(t);return}if(e.closest(O)){let n=e.closest(p),o=n.querySelector(d)?.textContent??"",s=n.querySelector(_)?.textContent??"",r=n.querySelector(S)?.textContent??"";U({name:o,position:s,phone:r})}At(t)});document.querySelector(P)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let n=t.target;if(n.matches(q)){yt(t);return}if(n.closest(O)){let o=n.closest(p),s=o.querySelector(d)?.textContent??"",r=o.querySelector(_)?.textContent??"",a=o.querySelector(S)?.textContent??"";U({name:s,position:r,phone:a})}At(t)}});var wt=document.querySelector(z);function Ht(t,e){if(e.innerHTML="",t.length===0){e.textContent="No results found";return}t.forEach(({name:n,position:o,phone:s})=>{let r=k({name:n,position:o,phone:s});e.appendChild(r)})}function bt(t,e){t.addEventListener("input",()=>{let n=t.value.trim().toLowerCase();if(n){let o=dt(n);Ht(o,e)}else e.innerHTML=""})}function xt(){h(wt);let t=c.querySelector(at),e=c.querySelector(D);bt(t,e),c.querySelector(lt).addEventListener("click",Bt)}function Bt(){let t=u(),e=c.querySelector(D);Ht(t,e),c.querySelector("input").focus()}var F=document.getElementById(Et),G=document.getElementById(ut),$=document.getElementById(mt);function Ut(){let t=F.value.trim(),e=G.value.trim(),n=$.value.trim(),o=document.querySelector(pt),s=[F,G,$],{ok:r,errors:a}=x(s,u(),o);if(!r){a.forEach(({input:C,message:f})=>{C?H(C,o,f):o.textContent=f});return}let l=t[0].toUpperCase(),E=document.querySelector(`[data-id="${l.toLowerCase()}"]`)?.closest(m);ht({name:t,position:e,phone:n},E),F.value="",G.value="",$.value=""}function kt(){document.querySelectorAll(m).forEach(t=>{let e=t.querySelector(L);e.innerHTML="";let n=t.querySelector(M);new T(n,e).reset()}),_t()}var Ft=document.querySelector(it);Ft.addEventListener("submit",t=>{t.preventDefault(),Ut()});var Gt=document.querySelector(Tt);Gt.addEventListener("click",t=>{let e=t.target;e.matches(Q)&&kt(),e.matches(X)&&xt()});export{F as nameInput,$ as phoneInput,G as positionInput};
