var b=".body";var w="#message";var U=".element",M="element--active";var C=".element__contacts",I="element__contacts--open",B=".element__counter",h="element__counter--active",k=".element__message",f=".column__element",m=".message",E=".message__name",i=".message__position",u=".message__phone",g=".contact-table",x=".js-delete-contact-button",_=".js-edit-contact-button";var G="#edit-popup-content",F="#popup-name",V="#popup-position",$="#popup-phone";var K=".modal",Y=".modal__title",j=".modal__body";var L=class{constructor(e,o){this.counterElement=e,this.contactsContainer=o,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(h),e.classList.add(M)):(this.counterElement.classList.remove(h),e.classList.remove(M))),this.counterElement.textContent=this.count.toString()}};function J(t){let e=localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch(o){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",o),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return null}function y(t,e){localStorage.setItem(t,JSON.stringify(e))}var N="contacts",p=J(N)||[];function d(){return p}function W({name:t,position:e,phone:o}){let n={name:t,position:e,phone:o};p.push(n),y(N,p)}function z({name:t,position:e,phone:o}){p=p.filter(n=>n.name!==t||n.position!==e||n.phone!==o),y(N,p)}var Z=t=>t.key==="Escape";var a=document.querySelector(K),Q=document.querySelector(b);function X(t){a.showModal(),Q.style.overflow="hidden";let e=a.querySelector(j);e.innerHTML="";let o=t.content.cloneNode(!0);e.appendChild(o),a.querySelector("input").focus(),document.addEventListener("keydown",S)}function tt(){a.close(),Q.style.overflow="auto",document.removeEventListener("keydown",S)}function S(t){Z(t)&&(t.preventDefault(),tt())}var et=document.querySelector(G),A,R,v,ct=null;function P(t){et&&X(et);let e=a.querySelector(Y);e&&(e.textContent="Edit contact"),ct=t,A=a.querySelector(F),R=a.querySelector(V),v=a.querySelector($),A&&R&&v&&(A.value=t.name,R.value=t.position,v.value=t.phone),a.querySelector("input").focus(),document.addEventListener("keydown",S)}var O={};function lt({name:t,position:e,phone:o}){let r=document.querySelector(w).content.querySelector(m)?.cloneNode(!0);if(r){let s=r.querySelector(E),l=r.querySelector(i),T=r.querySelector(u);s.textContent=t,l.textContent=e,T.textContent=o}return r}function Et(t,e){e.innerHTML="",t.forEach(({name:o,position:n,phone:c})=>{let r=lt({name:o,position:n,phone:c});e.append(r)})}function ot(t,e){let o=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(f);if(o){let n=o.querySelector(C);Et(e,n);let c=o.querySelector(B);O[t]||(O[t]=new L(c,n)),O[t].count=e.length,O[t].update()}}function Ut({name:t,position:e,phone:o},n,c=!0){c&&W({name:t,position:e,phone:o});let r=n.querySelector("[data-id]")?.textContent?.toUpperCase()??"",s=d().filter(l=>l.name[0].toUpperCase()===r);ot(r,s)}function nt(t){let o=t.target.closest(m);if(!o)return;let n=o.querySelector(E)?.textContent??"",c=o.querySelector(i)?.textContent??"",r=o.querySelector(u)?.textContent??"";z({name:n,position:c,phone:r}),o.remove();let s=n[0].toUpperCase(),l=d().filter(T=>T.name[0].toUpperCase()===s);ot(s,l)}function at(t,e){let o=t.name[0].toUpperCase(),n=document.querySelector(`[data-id="${o.toLowerCase()}"]`)?.closest(f);n&&n.querySelector(C).querySelectorAll(k).forEach(s=>{let l=s.querySelector(E)?.textContent??"",T=s.querySelector(i)?.textContent??"",st=s.querySelector(u)?.textContent??"";if(l===t.name&&T===t.position&&st===t.phone){let H=s.querySelector(E),q=s.querySelector(i),D=s.querySelector(u);H&&q&&D&&(H.textContent=e.name,q.textContent=e.position,D.textContent=e.phone)}})}function rt(t){let e=t.target;if(e.closest(f)){let o=e.closest(U);if(!o)return;let n=o.querySelector(C);if(!n)return;n.classList.toggle(I),n.classList.contains(I)?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight="0"}}document.querySelector(g)?.addEventListener("click",t=>{let e=t.target;if(e.closest(x)){nt(t);return}if(e.closest(_)){let o=e.closest(m),n=o.querySelector(E)?.textContent??"",c=o.querySelector(i)?.textContent??"",r=o.querySelector(u)?.textContent??"";P({name:n,position:c,phone:r})}rt(t)});document.querySelector(g)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let o=t.target;if(o.matches(x)){nt(t);return}if(o.closest(_)){let n=o.closest(m),c=n.querySelector(E)?.textContent??"",r=n.querySelector(i)?.textContent??"",s=n.querySelector(u)?.textContent??"";P({name:c,position:r,phone:s})}rt(t)}});export{Ut as addContact,nt as deleteContact,lt as renderContactElement,Et as renderContacts,at as updateContact};
