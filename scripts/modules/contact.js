var b=".body";var w="#message";var U=".element",O="element--active";var C=".element__contacts",M="element__contacts--open",B=".element__counter",I="element__counter--active",k=".element__message",f=".column__element",m=".message",i=".message__name",E=".message__position",u=".message__phone",h=".contact-table",x=".js-delete-contact-button",_=".js-edit-contact-button";var G="#edit-popup-content",F="#popup-name",V="#popup-position",$="#popup-phone";var K=".modal",Y=".modal__title",j=".modal__body";var L=class{constructor(e,n){this.counterElement=e,this.contactsContainer=n,this.count=0}increase(){this.count++,this.update()}decrease(){this.count>0&&(this.count--,this.update())}reset(){this.count=0,this.update()}update(){let e=this.contactsContainer.parentElement;e&&(this.count>0?(this.counterElement.classList.add(I),e.classList.add(O)):(this.counterElement.classList.remove(I),e.classList.remove(O))),this.counterElement.textContent=this.count.toString()}};function J(t){let e=localStorage.getItem(t);if(e)try{return JSON.parse(e)}catch(n){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",n),new Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage")}return null}function y(t,e){localStorage.setItem(t,JSON.stringify(e))}var N="contacts",p=J(N)||[];function d(){return p}function W({name:t,position:e,phone:n}){let o={name:t,position:e,phone:n};p.push(o),y(N,p)}function z({name:t,position:e,phone:n}){p=p.filter(o=>o.name!==t||o.position!==e||o.phone!==n),y(N,p)}var Z=t=>t.key==="Escape";var a=document.querySelector(K),Q=document.querySelector(b);function X(t){a.showModal(),Q.style.overflow="hidden";let e=a.querySelector(j);e.innerHTML="";let n=t.content.cloneNode(!0);e.appendChild(n),a.querySelector("input").focus(),document.addEventListener("keydown",S)}function tt(){a.close(),Q.style.overflow="auto",document.removeEventListener("keydown",S)}function S(t){Z(t)&&(t.preventDefault(),tt())}var et=document.querySelector(G),A,R,v,ct=null;function P(t){et&&X(et);let e=a.querySelector(Y);e&&(e.textContent="Edit contact"),ct=t,A=a.querySelector(F),R=a.querySelector(V),v=a.querySelector($),A&&R&&v&&(A.value=t.name,R.value=t.position,v.value=t.phone),a.querySelector("input").focus(),document.addEventListener("keydown",S)}var g={};function lt({name:t,position:e,phone:n}){let r=document.querySelector(w).content.querySelector(m)?.cloneNode(!0);if(r){let s=r.querySelector(i),l=r.querySelector(E),T=r.querySelector(u);s.textContent=t,l.textContent=e,T.textContent=n}return r}function it(t,e){e.innerHTML="",t.forEach(({name:n,position:o,phone:c})=>{let r=lt({name:n,position:o,phone:c});e.append(r)})}function nt(t,e){let n=document.querySelector(`[data-id="${t.toLowerCase()}"]`)?.closest(f);if(n){let o=n.querySelector(C);it(e,o);let c=n.querySelector(B);g[t]||(g[t]=new L(c,o)),g[t].count=e.length,g[t].update()}}function Ut({name:t,position:e,phone:n},o,c=!0){c&&W({name:t,position:e,phone:n});let r=o.querySelector("[data-id]")?.textContent?.toUpperCase()??"",s=d().filter(l=>l.name[0].toUpperCase()===r);nt(r,s)}function ot(t){let n=t.target.closest(m);if(!n)return;let o=n.querySelector(i)?.textContent??"",c=n.querySelector(E)?.textContent??"",r=n.querySelector(u)?.textContent??"";z({name:o,position:c,phone:r}),n.remove();let s=o[0].toUpperCase(),l=d().filter(T=>T.name[0].toUpperCase()===s);nt(s,l)}function at(t,e){let n=t.name[0].toUpperCase(),o=document.querySelector(`[data-id="${n.toLowerCase()}"]`)?.closest(f);o&&o.querySelector(C).querySelectorAll(k).forEach(s=>{let l=s.querySelector(i)?.textContent??"",T=s.querySelector(E)?.textContent??"",st=s.querySelector(u)?.textContent??"";if(l===t.name&&T===t.position&&st===t.phone){let H=s.querySelector(i),q=s.querySelector(E),D=s.querySelector(u);H&&q&&D&&(H.textContent=e.name,q.textContent=e.position,D.textContent=e.phone)}})}function rt(t){let e=t.target;if(e.closest(f)){let n=e.closest(U);if(!n)return;let o=n.querySelector(C);if(!o)return;o.classList.toggle(M),o.classList.contains(M)?o.style.maxHeight=`${o.scrollHeight}px`:o.style.maxHeight="0"}}document.querySelector(h)?.addEventListener("click",t=>{let e=t.target;if(e.closest(x)){ot(t);return}if(e.closest(_)){let n=e.closest(m),o=n.querySelector(i)?.textContent??"",c=n.querySelector(E)?.textContent??"",r=n.querySelector(u)?.textContent??"";P({name:o,position:c,phone:r})}rt(t)});document.querySelector(h)?.addEventListener("keydown",t=>{let e=t;if(e.key===" "||e.key==="Enter"){t.preventDefault();let n=t.target;if(n.matches(x)){ot(t);return}if(n.closest(_)){let o=n.closest(m),c=o.querySelector(i)?.textContent??"",r=o.querySelector(E)?.textContent??"",s=o.querySelector(u)?.textContent??"";P({name:c,position:r,phone:s})}rt(t)}});export{Ut as addContact,ot as deleteContact,lt as renderContactElement,it as renderContacts,at as updateContact};
