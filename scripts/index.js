var ce=document.querySelector("#letter").content.querySelector(".element"),le=({letter:r,id:a})=>{let s=ce.cloneNode(!0);return s.querySelector(".element__letter").textContent=r,s.querySelector(".element__letter").dataset.id=a,s.setAttribute("tabindex","0"),s},H=(r,a)=>{let s=document.createDocumentFragment();r.forEach(g=>{let C=le(g);s.append(C)}),a.append(s)};var U=[{letter:"A",id:"a"},{letter:"B",id:"b"},{letter:"C",id:"c"},{letter:"D",id:"d"},{letter:"E",id:"e"},{letter:"F",id:"f"},{letter:"G",id:"g"},{letter:"H",id:"h"},{letter:"I",id:"i"},{letter:"J",id:"j"},{letter:"K",id:"k"},{letter:"L",id:"l"},{letter:"M",id:"m"}],V=[{letter:"N",id:"n"},{letter:"O",id:"o"},{letter:"P",id:"p"},{letter:"Q",id:"q"},{letter:"R",id:"r"},{letter:"S",id:"s"},{letter:"T",id:"t"},{letter:"U",id:"U"},{letter:"V",id:"v"},{letter:"W",id:"w"},{letter:"X",id:"x"},{letter:"Y",id:"y"},{letter:"Z",id:"z"}];var S=document.querySelector(".interaction__error"),f="input--error";function ae(r){r.classList.contains(f)||(r.classList.add(f),S.textContent="Fill in all fields!")}function D(r){let a=!0;return r.forEach(s=>{M(s),s.value.trim()||(ae(s),a=!1)}),a}function M(r){r.addEventListener("input",()=>{r.classList.remove(f),S.textContent=""})}function F(r,a,s,g){return r.has(`${a.toLowerCase()}|${s.toLowerCase()}|${g}`)}function X(){S.textContent="This contact has already been recorded!"}function P(r){M(r);let a=/[a-zA-Z ]/gmi;return r.value.length<=3?(r.classList.add(f),S.textContent="Value cannot be shorter than 3 letters!",!1):a.test(r.value)?!0:(r.classList.add(f),S.textContent="Value must contain English letters!",!1)}function Z(r){return M(r),r.value.length<11||r.value.length>16?(r.classList.add(f),S.textContent="The length should be from 11 to 16 characters!",!1):!0}document.addEventListener("DOMContentLoaded",()=>{let r=document.querySelector(".column__left"),a=document.querySelector(".column__right");H(U,r),H(V,a);let s=new Map;function g(){let t=localStorage.getItem("contacts");if(t)try{let e=JSON.parse(t);Array.isArray(e)&&e.forEach(({name:o,position:n,phone:c})=>{let l=o[0].toUpperCase(),u=document.querySelector(`[data-id="${l.toLowerCase()}"]`)?.closest(".column__element");u&&T(o,n,c,u)})}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",e)}}function C(){let t=Array.from(s.values());localStorage.setItem("contacts",JSON.stringify(t))}let $=(t,e,o)=>{let c=document.querySelector("#message").content.querySelector(".message").cloneNode(!0);return c.querySelector(".message__name").textContent=t,c.querySelector(".message__position").textContent=e,c.querySelector(".message__phone").textContent=o,c};function T(t,e,o,n,c=!0){let l=$(t,e,o);n.querySelector(".element__contacts").append(l),q(n),s.set(`${t.toLowerCase()}|${e.toLowerCase()}|${o}`,{name:t,position:e,phone:o}),c&&C()}let E=document.getElementById("name"),h=document.getElementById("position"),L=document.getElementById("phone");document.querySelector(".buttons__button--add").addEventListener("click",t=>{t.preventDefault();let e=E.value.trim(),o=h.value.trim(),n=L.value.trim();if(!D([E,h,L]))return;if(F(s,e,o,n)){X();return}if(!P(E)||!P(h)||!Z(L))return;let l=e[0].toUpperCase(),u=document.querySelector(`[data-id="${l.toLowerCase()}"]`)?.closest(".column__element");T(e,o,n,u),E.value="",h.value="",L.value=""}),document.querySelectorAll(".element__container").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let n=e.target.closest(".element").querySelector(".element__contacts");n.classList.toggle("element__contacts--open"),n.classList.contains("element__contacts--open")?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight=0})});function q(t){let e=t.querySelector(".element__counter"),n=t.querySelector(".element__contacts").children.length;n>0?(e.classList.add("element__counter--active"),e.textContent=n):(e.classList.remove("element__counter--active"),e.textContent=0)}let J=t=>{let e=t.target.closest(".message__delete");if(!e)return;let o=e.closest(".message"),n=o.querySelector(".message__name").textContent,c=o.querySelector(".message__position").textContent,l=o.querySelector(".message__phone").textContent;if(s.delete(`${n.toLowerCase()}|${c.toLowerCase()}|${l}`),o){o.remove();let u=n[0].toUpperCase(),d=document.querySelector(`[data-id="${u.toLowerCase()}"]`)?.closest(".column__element");d&&(d.querySelector(".element__contacts").querySelectorAll(".element__message").forEach(i=>{let w=i.querySelector(".message__name").textContent,N=i.querySelector(".message__position").textContent,A=i.querySelector(".message__phone").textContent;w===n&&N===c&&A===l&&i.remove()}),q(d)),o.remove(),C()}};document.addEventListener("click",J);let R=document.querySelector(".buttons__button--clear"),z=()=>{document.querySelectorAll(".column__element").forEach(t=>{let e=t.querySelector(".element__contacts");e.innerHTML="",q(t)}),s.clear(),C()};R.addEventListener("click",z),g();let _=document.querySelector("#edit-popup"),k=_.querySelector(".popup__input--name"),I=_.querySelector(".popup__input--position"),B=_.querySelector(".popup__input--phone"),K=_.querySelector(".popup__button-save"),j=_.querySelector(".popup__button-cancel"),Q=document.querySelector(".popup__overlay"),m=null;function b(t){m=t,k.value=t.querySelector(".message__name").textContent,I.value=t.querySelector(".message__position").textContent,B.value=t.querySelector(".message__phone").textContent,_.classList.add("popup--open")}function v(){_.classList.remove("popup--open"),m=null}K.addEventListener("click",()=>{let t=k.value.trim(),e=I.value.trim(),o=B.value.trim(),n=m.querySelector(".message__name").textContent,c=m.querySelector(".message__position").textContent,l=m.querySelector(".message__phone").textContent;s.delete(`${n.toLowerCase()}|${c.toLowerCase()}|${l}`),s.set(`${t.toLowerCase()}|${e.toLowerCase()}|${o}`,{name:t,position:e,phone:o}),m.querySelector(".message__name").textContent=t,m.querySelector(".message__position").textContent=e,m.querySelector(".message__phone").textContent=o;let u=n[0].toUpperCase(),d=document.querySelector(`[data-id="${u.toLowerCase()}"]`)?.closest(".column__element");d&&d.querySelector(".element__contacts").querySelectorAll(".element__message").forEach(i=>{let w=i.querySelector(".message__name").textContent,N=i.querySelector(".message__position").textContent,A=i.querySelector(".message__phone").textContent;w===n&&N===c&&A===l&&(i.querySelector(".message__name").textContent=t,i.querySelector(".message__position").textContent=e,i.querySelector(".message__phone").textContent=o)}),C(),v()}),Q.addEventListener("click",v),j.addEventListener("click",v),document.addEventListener("click",t=>{if(t.target.classList.contains("message__edit")){let e=t.target.closest(".message");b(e)}});let W=document.querySelector(".buttons__button--search"),p=document.querySelector(".modal"),x=p.querySelector(".modal__input"),y=p.querySelector(".modal__search-area"),Y=p.querySelector(".modal__button-cancel"),ee=p.querySelector(".modal__overlay"),te=p.querySelector(".modal__button-show");W.addEventListener("click",()=>{p.classList.add("modal--open"),document.querySelector(".body").style.overflow="hidden"});function oe(t){let e=[];return s.forEach(({name:o,position:n,phone:c})=>{(o.toLowerCase().includes(t)||n.toLowerCase().includes(t)||c.includes(t))&&e.push({name:o,position:n,phone:c})}),e}function O(t){if(y.innerHTML="",t.length===0){y.textContent="No results found";return}t.forEach(({name:e,position:o,phone:n})=>{let c=$(e,o,n);y.appendChild(c)})}x.addEventListener("input",()=>{let t=x.value.trim().toLowerCase();if(t){let e=oe(t);O(e)}else y.innerHTML=""}),y.addEventListener("click",t=>{let e=t.target.closest(".message__delete");if(e){let o=e.closest(".element__message");if(o){let n=o.querySelector(".message__name").textContent,c=o.querySelector(".message__position").textContent,l=o.querySelector(".message__phone").textContent;s.delete(`${n.toLowerCase()}|${c.toLowerCase()}|${l}`),o.remove();let u=n[0].toUpperCase(),d=document.querySelector(`[data-id="${u.toLowerCase()}"]`)?.closest(".column__element");d&&q(d)}}}),y.addEventListener("click",t=>{let e=t.target.closest(".message__edit");if(e){let o=e.closest(".element__message");o&&b(o)}}),te.addEventListener("click",()=>{let t=Array.from(s.values());O(t)});function G(){p.classList.remove("modal--open"),x.value="",y.innerHTML="",document.querySelector(".body").style.overflow="auto"}Y.addEventListener("click",G),ee.addEventListener("click",G);function ne(t){let e=t.keyCode;return e>=48&&e<=57||e>=96&&e<=109||e===8||e===9||e===187||e===189||e===32||e===37||e===39}L.addEventListener("keydown",t=>{ne(t)||t.preventDefault()})});
