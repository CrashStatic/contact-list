var le=document.querySelector("#letter").content.querySelector(".element"),ae=({letter:r,id:i})=>{let c=le.cloneNode(!0);return c.querySelector(".element__letter").textContent=r,c.querySelector(".element__letter").dataset.id=i,c.setAttribute("tabindex","0"),c},A=(r,i)=>{let c=document.createDocumentFragment();r.forEach(f=>{let p=ae(f);c.append(p)}),i.append(c)};var G=[{letter:"A",id:"a"},{letter:"B",id:"b"},{letter:"C",id:"c"},{letter:"D",id:"d"},{letter:"E",id:"e"},{letter:"F",id:"f"},{letter:"G",id:"g"},{letter:"H",id:"h"},{letter:"I",id:"i"},{letter:"J",id:"j"},{letter:"K",id:"k"},{letter:"L",id:"l"},{letter:"M",id:"m"}],U=[{letter:"N",id:"n"},{letter:"O",id:"o"},{letter:"P",id:"p"},{letter:"Q",id:"q"},{letter:"R",id:"r"},{letter:"S",id:"s"},{letter:"T",id:"t"},{letter:"U",id:"U"},{letter:"V",id:"v"},{letter:"W",id:"w"},{letter:"X",id:"x"},{letter:"Y",id:"y"},{letter:"Z",id:"z"}];var g=document.querySelector(".interaction__error"),L="input--error";function ue(r){r.classList.contains(L)||(r.classList.add(L),g.textContent="Fill in all fields!")}function V(r){let i=!0;return r.forEach(c=>{H(c),c.value.trim()||(ue(c),i=!1)}),i}function H(r){r.addEventListener("input",()=>{r.classList.remove(L),g.textContent=""})}function D(){g.textContent="This contact has already been recorded!"}function M(r){H(r);let i=/[a-zA-Z ]/gmi;return r.value.length<=3?(r.classList.add(L),g.textContent="Value cannot be shorter than 3 letters!",!1):i.test(r.value)?!0:(r.classList.add(L),g.textContent="Value must contain English letters!",!1)}function F(r){return H(r),r.value.length<11||r.value.length>16?(r.classList.add(L),g.textContent="The length should be from 11 to 16 characters!",!1):!0}document.addEventListener("DOMContentLoaded",()=>{let r=document.querySelector(".column__left"),i=document.querySelector(".column__right");A(G,r),A(U,i);let c=document.getElementById("name"),f=document.getElementById("position"),p=document.getElementById("phone"),X=document.querySelector(".buttons__button--add"),d=new Map;function Z(){let t=localStorage.getItem("contacts");if(t)try{let e=JSON.parse(t);Array.isArray(e)&&e.forEach(({name:o,position:n,phone:s})=>{let l=o[0].toUpperCase(),a=document.querySelector(`[data-id="${l.toLowerCase()}"]`)?.closest(".column__element");a&&$(o,n,s,a)})}catch(e){console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 \u0434\u0430\u043D\u043D\u044B\u0445 \u0438\u0437 localStorage:",e)}}function E(){let t=Array.from(d.values());localStorage.setItem("contacts",JSON.stringify(t))}function J(t,e,o){return d.has(`${t.toLowerCase()}|${e.toLowerCase()}|${o}`)}let P=(t,e,o)=>{let s=document.querySelector("#message").content.querySelector(".message").cloneNode(!0);return s.querySelector(".message__name").textContent=t,s.querySelector(".message__position").textContent=e,s.querySelector(".message__phone").textContent=o,s};function $(t,e,o,n,s=!0){let l=P(t,e,o);n.querySelector(".element__contacts").append(l),h(n),d.set(`${t.toLowerCase()}|${e.toLowerCase()}|${o}`,{name:t,position:e,phone:o}),s&&E()}X.addEventListener("click",t=>{t.preventDefault();let e=c.value.trim(),o=f.value.trim(),n=p.value.trim();if(!V([c,f,p]))return;if(J(e,o,n)){D();return}if(!M(c)||!M(f)||!F(p))return;let l=e[0].toUpperCase(),a=document.querySelector(`[data-id="${l.toLowerCase()}"]`)?.closest(".column__element");$(e,o,n,a),c.value="",f.value="",p.value=""}),document.querySelectorAll(".element__container").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let n=e.target.closest(".element").querySelector(".element__contacts");n.classList.toggle("element__contacts--open"),n.classList.contains("element__contacts--open")?n.style.maxHeight=`${n.scrollHeight}px`:n.style.maxHeight=0})});function h(t){let e=t.querySelector(".element__counter"),n=t.querySelector(".element__contacts").children.length;n>0?(e.classList.add("element__counter--active"),e.textContent=n):(e.classList.remove("element__counter--active"),e.textContent=0)}let R=t=>{let e=t.target.closest(".message__delete");if(!e)return;let o=e.closest(".message"),n=o.querySelector(".message__name").textContent,s=o.querySelector(".message__position").textContent,l=o.querySelector(".message__phone").textContent;if(d.delete(`${n.toLowerCase()}|${s.toLowerCase()}|${l}`),o){o.remove();let a=n[0].toUpperCase(),m=document.querySelector(`[data-id="${a.toLowerCase()}"]`)?.closest(".column__element");m&&(m.querySelector(".element__contacts").querySelectorAll(".element__message").forEach(u=>{let x=u.querySelector(".message__name").textContent,w=u.querySelector(".message__position").textContent,N=u.querySelector(".message__phone").textContent;x===n&&w===s&&N===l&&u.remove()}),h(m)),o.remove(),E()}};document.addEventListener("click",R);let z=document.querySelector(".buttons__button--clear"),K=()=>{document.querySelectorAll(".column__element").forEach(t=>{let e=t.querySelector(".element__contacts");e.innerHTML="",h(t)}),d.clear(),E()};z.addEventListener("click",K),Z();let y=document.querySelector("#edit-popup"),T=y.querySelector(".popup__input--name"),k=y.querySelector(".popup__input--position"),I=y.querySelector(".popup__input--phone"),j=y.querySelector(".popup__button-save"),Q=y.querySelector(".popup__button-cancel"),W=document.querySelector(".popup__overlay"),_=null;function B(t){_=t,T.value=t.querySelector(".message__name").textContent,k.value=t.querySelector(".message__position").textContent,I.value=t.querySelector(".message__phone").textContent,y.classList.add("popup--open")}function q(){y.classList.remove("popup--open"),_=null}j.addEventListener("click",()=>{let t=T.value.trim(),e=k.value.trim(),o=I.value.trim(),n=_.querySelector(".message__name").textContent,s=_.querySelector(".message__position").textContent,l=_.querySelector(".message__phone").textContent;d.delete(`${n.toLowerCase()}|${s.toLowerCase()}|${l}`),d.set(`${t.toLowerCase()}|${e.toLowerCase()}|${o}`,{name:t,position:e,phone:o}),_.querySelector(".message__name").textContent=t,_.querySelector(".message__position").textContent=e,_.querySelector(".message__phone").textContent=o;let a=n[0].toUpperCase(),m=document.querySelector(`[data-id="${a.toLowerCase()}"]`)?.closest(".column__element");m&&m.querySelector(".element__contacts").querySelectorAll(".element__message").forEach(u=>{let x=u.querySelector(".message__name").textContent,w=u.querySelector(".message__position").textContent,N=u.querySelector(".message__phone").textContent;x===n&&w===s&&N===l&&(u.querySelector(".message__name").textContent=t,u.querySelector(".message__position").textContent=e,u.querySelector(".message__phone").textContent=o)}),E(),q()}),W.addEventListener("click",q),Q.addEventListener("click",q),document.addEventListener("click",t=>{if(t.target.classList.contains("message__edit")){let e=t.target.closest(".message");B(e)}});let Y=document.querySelector(".buttons__button--search"),C=document.querySelector(".modal"),v=C.querySelector(".modal__input"),S=C.querySelector(".modal__search-area"),ee=C.querySelector(".modal__button-cancel"),te=C.querySelector(".modal__overlay"),oe=C.querySelector(".modal__button-show");Y.addEventListener("click",()=>{C.classList.add("modal--open"),document.querySelector(".body").style.overflow="hidden"});function ne(t){let e=[];return d.forEach(({name:o,position:n,phone:s})=>{(o.toLowerCase().includes(t)||n.toLowerCase().includes(t)||s.includes(t))&&e.push({name:o,position:n,phone:s})}),e}function b(t){if(S.innerHTML="",t.length===0){S.textContent="No results found";return}t.forEach(({name:e,position:o,phone:n})=>{let s=P(e,o,n);S.appendChild(s)})}v.addEventListener("input",()=>{let t=v.value.trim().toLowerCase();if(t){let e=ne(t);b(e)}else S.innerHTML=""}),S.addEventListener("click",t=>{let e=t.target.closest(".message__delete");if(e){let o=e.closest(".element__message");if(o){let n=o.querySelector(".message__name").textContent,s=o.querySelector(".message__position").textContent,l=o.querySelector(".message__phone").textContent;d.delete(`${n.toLowerCase()}|${s.toLowerCase()}|${l}`),o.remove();let a=n[0].toUpperCase(),m=document.querySelector(`[data-id="${a.toLowerCase()}"]`)?.closest(".column__element");m&&h(m)}}}),S.addEventListener("click",t=>{let e=t.target.closest(".message__edit");if(e){let o=e.closest(".element__message");o&&B(o)}}),oe.addEventListener("click",()=>{let t=Array.from(d.values());b(t)});function O(){C.classList.remove("modal--open"),v.value="",S.innerHTML="",document.querySelector(".body").style.overflow="auto"}ee.addEventListener("click",O),te.addEventListener("click",O);function re(t){let e=t.keyCode;return e>=48&&e<=57||e>=96&&e<=109||e===8||e===9||e===187||e===189||e===32||e===37||e===39}p.addEventListener("keydown",t=>{re(t)||t.preventDefault()})});
